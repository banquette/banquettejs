<div
    class="bt-form-file"
    :data-is-multiple="vm.multiple ? '' : null"
    :data-has-value="vm.files.length > 0 ? '' : null"
    :data-has-placeholder="vm.placeholder ? '' : null"
    :data-has-help="hasSlot('help') ? '' : null"
    :data-has-focus="vm.focused ? '' : null"
    :data-is-disabled="vm.disabled ? '' : null"
    :data-has-error="vm.invalid && vm.validated ? '' : null"
>
    <div class="control-wrapper">
        <label :for="vm.fullId" v-if="hasSlot('default')"><span><slot></slot></span></label>
        <label :for="vm.fullId" v-else-if="vm.label"><span>{{ vm.label }}</span></label>

        <div ref="inputWrapper" class="input-wrapper">
            <input
                ref="input"
                type="file"
                :multiple="vm.multiple ? '' : null"
                :accept="vm.accept"
                data-file-input
                @change="vm.onFileSelectionChange"
            />
            <div data-control>
                <div class="browse-button" @click="$refs.input.click()">
                    <slot name="button-text">Choose file</slot>
                </div>
                <div v-for="uploadFile in vm.files" class="file-item">
                    <icon-insert-drive-file></icon-insert-drive-file>
                    <div class="file-details">
                        <div class="file-name">{{ uploadFile.file.name }}</div>
                        <bt-progress-horizontal :progress="uploadFile.progress "></bt-progress-horizontal>
                        <div class="file-size">{{ uploadFile.uploadedSizeText }} / {{ uploadFile.totalSizeText }} ({{ uploadFile.progress }}%)</div>
                    </div>
                    <div class="buttons">
                        <bt-button @click="vm.start(uploadFile)" v-if="uploadFile.paused || uploadFile.failed">
                            <icon-file-upload></icon-file-upload>
                        </bt-button>
                        <bt-button @click="vm.pause(uploadFile)" v-if="uploadFile.uploading">
                            <icon-stop></icon-stop>
                        </bt-button>
                        <bt-button @click="vm.cancel(uploadFile)">
                            <icon-close></icon-close>
                        </bt-button>
                    </div>
                </div>
            </div>
            <slot name="errors">
                <bt-form-error v-if="vm.invalid && vm.validated" :errors="vm.errors" :target="inputWrapper" :placement="errorPlacement">
                    <slot name="error" :errors="vm.errors" :errors-map="vm.errorsMap"></slot>
                </bt-form-error>
            </slot>
        </div>
    </div>
    <div v-if="hasSlot('help')" class="help">
        <slot name="help"></slot>
    </div>
</div>
