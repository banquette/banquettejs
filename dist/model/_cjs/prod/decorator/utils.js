/*!
 * Banquette Model v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@banquette/dependency-injection/_cjs/prod/injector"),r=require("@banquette/exception/_cjs/prod/usage.exception"),t=require("@banquette/utils-reflection/_cjs/prod/get-function-arguments"),o=require("@banquette/utils-string/_cjs/prod/is-non-empty-string"),n=require("@banquette/utils-type/_cjs/prod/is-function"),a=require("@banquette/utils-type/_cjs/prod/is-number"),i=require("@banquette/utils-type/_cjs/prod/is-type"),u=require("@banquette/utils-type/_cjs/prod/is-undefined"),c=require("../model-metadata.service.js"),s=require("../model-transform-metadata.service.js"),p=require("../transformer/type/model.js"),l=e.Injector.Get(s.ModelTransformMetadataService),f=e.Injector.Get(c.ModelMetadataService);function propertyDecorator(e,c){return void 0===c&&(c="This decorator can only be used on properties."),function(s,p,l){var f=s;u.isUndefined(p)&&a.isNumber(l)?p=t.getFunctionArguments(s)[l]:f=s.constructor;if(!i.isType(p,o.isNonEmptyString)||n.isFunction(f.prototype[p]))throw new r.UsageException(c);return e(f,p)}}function createTransformableDecorator(e,r){return propertyDecorator((function(t,o){l.replace(t,e,o,r)}),"You can only apply a transform decorator on properties.")}exports.createRelationAwareTransformableDecorator=function createRelationAwareTransformableDecorator(e,r,t){var apply=function(r,t,o){createTransformableDecorator(e,o)(r,t)};return function(e,o){apply(e,o,r||t),u.isUndefined(r)?queueMicrotask((function(){null!==f.getRelation(e.constructor,o)&&apply(e,o,p.Model())})):apply(e,o,r)}},exports.createTransformableDecorator=createTransformableDecorator,exports.propertyDecorator=propertyDecorator;
