/*!
 * Banquette Storage v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_virtual/_tslib.js"),t=require("@banquette/config/_cjs/prod/config/configuration.service"),r=require("@banquette/dependency-injection/_cjs/prod/decorator/inject-lazy.decorator"),a=require("@banquette/dependency-injection/_cjs/prod/decorator/inject-multiple.decorator"),i=require("@banquette/dependency-injection/_cjs/prod/decorator/service.decorator"),n=require("@banquette/dependency-injection/_cjs/prod/injector"),o=require("@banquette/exception/_cjs/prod/usage.exception"),u=require("@banquette/utils-type/_cjs/prod/is-constructor"),s=require("@banquette/utils-type/_cjs/prod/is-string"),c=require("@banquette/utils-type/_cjs/prod/is-symbol"),p=require("@banquette/utils-type/_cjs/prod/is-undefined"),d=require("./config.js"),l=require("./constant.js"),v=require("./exception/no-adapter-available.exception.js");require("./adapter/cookies.adapter.js"),require("./adapter/local-storage.adapter.js");var f=function(){function StorageService(e,t){this.availableAdaptersOrdered=[],this.availableAdaptersMap={};for(var r=0,a=e;r<a.length;r++){var i=a[r];i.isAvailable()&&(this.availableAdaptersOrdered.push(i),this.availableAdaptersMap[i.constructor.name]=i)}this.availableAdaptersOrdered.sort((function(e,t){return t.getPriority()-e.getPriority()})),this.defaultAdapter=this.resolveAdapter(t.get(d.StorageConfigurationSymbol).defaultAdapter)}return StorageService.prototype.use=function(e){return this.resolveAdapter(e)},StorageService.prototype.getDefaultAdapter=function(){return this.defaultAdapter},StorageService.prototype.get=function(e,t){return this.defaultAdapter.get(e,t)},StorageService.prototype.set=function(e,t){return this.defaultAdapter.set(e,t)},StorageService.prototype.remove=function(e){return this.defaultAdapter.remove(e)},StorageService.prototype.clear=function(){return this.defaultAdapter.clear()},StorageService.prototype.length=function(){return this.defaultAdapter.length()},StorageService.prototype.keys=function(){return this.defaultAdapter.keys()},StorageService.prototype.resolveAdapter=function(e){var t=null;if(s.isString(e)||p.isUndefined(e)){if(!this.availableAdaptersOrdered.length)throw new v.NoAdapterAvailableException;return this.availableAdaptersOrdered[0]}if(c.isSymbol(e))return n.Injector.Get(e);if(u.isConstructor(e)&&s.isString(e.name)&&(t=e.name),null===t)throw new o.UsageException("Failed to resolve adapter ".concat(String(e),"."));if(p.isUndefined(this.availableAdaptersMap[t]))throw new o.UsageException("No adapter ".concat(t," has been found in the list of available adapters."));return this.availableAdaptersMap[t]},StorageService=e.__decorate([i.Service(),e.__param(0,a.InjectMultiple(l.StorageAdapterTag)),e.__param(1,r.InjectLazy((function(){return t.ConfigurationService}))),e.__metadata("design:paramtypes",[Array,t.ConfigurationService])],StorageService)}();exports.StorageService=f;
