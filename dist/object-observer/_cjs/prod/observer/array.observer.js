/*!
 * Banquette ObjectObserver v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../_virtual/_tslib.js"),r=require("@banquette/utils-type/_cjs/prod/is-array"),e=require("@banquette/utils-type/_cjs/prod/is-undefined"),i=require("../constant.js"),n=require("../mutation.js"),a=require("../utils.js"),o=function(o){function ArrayObserver(){var t=null!==o&&o.apply(this,arguments)||this;return t.proxifiedPop=function(){if(t.proxy.length){var r=t.target.pop();return t.detachValue(r),t.notify(new n.Mutation(i.MutationType.Delete,[String(t.proxy.length)],r,void 0,t.target)),r}},t.proxifiedShift=function(){if(t.proxy.length){var r=t.target.shift();return t.detachValue(r),t.notify(new n.Mutation(i.MutationType.Delete,["0"],r,void 0,t.target)),r}},t.proxifiedUnshift=function(){for(var r=arguments,e=[],a=0;a<arguments.length;a++)e[a]=r[a];for(var o=0;o<e.length;++o)e[o]=t.observeProperty(String(o),e[o]);var s=Reflect.apply(t.target.unshift,t.target,e);for(o=0;o<e.length;++o)t.notify(new n.Mutation(i.MutationType.Insert,[String(o)],void 0,e[o],t.target));return s},t.proxifiedReverse=function(){return t.target.length>0&&(t.target.reverse(),t.reassignNames(),t.notify(new n.Mutation(i.MutationType.Reverse,[],void 0,t.proxy,t.target))),t.proxy},t.proxifiedSort=function(r){return t.target.length>0&&(t.target.sort(r),t.reassignNames(),t.notify(new n.Mutation(i.MutationType.Sort,[],void 0,t.proxy,t.target))),t.proxy},t.proxifiedFill=function(r,e,a){var o=t.target.slice(0);t.target.fill(r,e,a);for(var s=0;s<t.target.length;++s)t.target[s]=t.observeProperty(String(s),t.target[s]),o[s]!==t.target[s]&&t.notify(new n.Mutation(i.MutationType.Update,[String(s)],o[s],t.target[s],t.target));return t.proxy},t.proxifiedSplice=function(r,e){for(var a=arguments,o=[],s=2;s<arguments.length;s++)o[s-2]=a[s];for(var g=r<0?Math.max(0,t.target.length+r):r,p=t.target.splice.apply(t.target,[r].concat(e?[e]:[],o)),u=0;u<p.length;++u)t.detachValue(p[u]),t.notify(new n.Mutation(i.MutationType.Delete,[String(g+u)],p[u],void 0,t.target));for(u=0;u<o.length;++u)t.target[g+u]=t.observeProperty(String(u),o[u]),t.notify(new n.Mutation(i.MutationType.Insert,[String(g+u)],void 0,t.target[g+u],t.target));return t.reassignNames(),p},t.proxifiedCopyWithin=function(r,e,a){void 0===e&&(e=0),void 0===a&&(a=t.target.length);var o=r<0?Math.max(0,t.target.length+r):r,s=r<0?Math.max(0,t.target.length+r):r,g=a<0?Math.max(0,t.target.length+a):a,p=t.target.slice(0);t.target.copyWithin(r,e,a);for(var u=o,f=g-s;u<f;++u)p[u]!==t.target[u]&&t.notify(new n.Mutation(i.MutationType.Update,[String(u)],p[u],t.target[u],t.target));return t.target},t}return t.__extends(ArrayObserver,o),ArrayObserver.Supports=function(t){return r.isArray(t)},ArrayObserver.prototype.observe=function(t){for(var r=0;r<t.length;++r)t[r]=this.observeProperty(String(r),t[r])},ArrayObserver.prototype.get=function(t,r){return e.isUndefined(ArrayObserver.ArrayOverrides[r])?t[r]:this[ArrayObserver.ArrayOverrides[r]]},ArrayObserver.prototype.reassignNames=function(){for(var t=0;t<this.target.length;t++){var r=a.extractObserver(this.target[t]);null!==r&&r.updateName(String(t),this)}},ArrayObserver.ArrayOverrides={pop:"proxifiedPop",shift:"proxifiedShift",unshift:"proxifiedUnshift",reverse:"proxifiedReverse",sort:"proxifiedSort",splice:"proxifiedSplice",fill:"proxifiedFill",copyWithin:"proxifiedCopyWithin"},ArrayObserver}(require("./abstract.observer.js").AbstractObserver);exports.ArrayObserver=o;
