/*!
 * Banquette VueUi v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";var e=require("../../_virtual/_tslib.js"),t=require("@banquette/form/_cjs/prod/constant"),n=require("@banquette/form/_cjs/prod/form-object"),o=require("@banquette/form/_cjs/prod/form.factory"),a=require("@banquette/ui/_cjs/prod/table/constant"),r=require("@banquette/ui/_cjs/prod/table/pagination/constant"),i=require("@banquette/ui/_cjs/prod/table/table-view-model"),s=require("@banquette/utils-misc/_cjs/prod/proxy"),u=require("@banquette/utils-type/_cjs/prod/ensure-integer"),p=require("@banquette/vue-material-icons/_cjs/prod/keyboard-backspace"),c=require("@banquette/vue-material-icons/_cjs/prod/chevron-left"),m=require("@banquette/vue-material-icons/_cjs/prod/chevron-right"),l=require("@banquette/vue-typescript/_cjs/prod/decorator/component.decorator"),g=require("@banquette/vue-typescript/_cjs/prod/decorator/computed.decorator"),b=require("@banquette/vue-typescript/_cjs/prod/decorator/expose.decorator"),v=require("@banquette/vue-typescript/_cjs/prod/decorator/prop.decorator"),d=require("@banquette/vue-typescript/_cjs/prod/vue");require("../../form/select/component/select.component.vue.js"),require("../../form/select/component/choice/choice.component.vue.js"),require("../../form/select/component/group/group.component.vue.js"),require("../../form/text/text.component.vue.js");var h=require("../../form/text/text.component.vue_vue_type_script_lang.vue.js"),f=require("../../form/select/component/select.component.vue_vue_type_script_lang.vue.js"),y=function(d){function PaginationComponent(){var e=null!==d&&d.apply(this,arguments)||this;return e.form=o.FormFactory.Create({page:1,itemsPerPage:20}),e.unsubscribeCallbacks=[],e}return e.__extends(PaginationComponent,d),Object.defineProperty(PaginationComponent.prototype,"isOffset",{get:function(){return this.vm.pagination.strategy===r.PaginationStrategy.Offset},enumerable:!1,configurable:!0}),PaginationComponent.prototype.mounted=function(){this.bindPageControl(),this.bindItemsPerPageControl(),this.observeUpdates()},PaginationComponent.prototype.unmounted=function(){for(var e=0,t=this.unsubscribeCallbacks;e<t.length;e++){(0,t[e])()}this.unsubscribeCallbacks=[]},PaginationComponent.prototype.onPageTextControlKeyDown=function(e){"Enter"===e.key&&e.target instanceof HTMLElement&&e.target.blur()},PaginationComponent.prototype.bindPageControl=function(){var e=this,n=this.form.get("page");n.setValue(this.vm.pagination.page),this.unsubscribeCallbacks.push(n.onStateChanged((function(n){n.state===t.BasicState.Focused&&!n.newValue&&n.source.value&&e.vm.pagination.goTo(u.ensureInteger(n.source.value))}))),this.unsubscribeCallbacks.push(n.onBeforeValueChange((function(t){t.newValue=String(t.newValue).replace(/\s*/,""),t.newValue&&(String(t.newValue).match(/^[0-9]+$/)?(t.newValue=Math.max(1,u.ensureInteger(t.newValue)),e.vm.pagination.currentState&&(t.newValue=Math.min(t.newValue,e.vm.pagination.currentState.totalPagesCount)),t.newValue===t.source.value&&t.refuse()):t.refuse())})))},PaginationComponent.prototype.bindItemsPerPageControl=function(){var e=this,t=this.form.get("itemsPerPage");t.setValue(this.vm.pagination.itemsPerPage),this.unsubscribeCallbacks.push(t.onValueChanged((function(t){e.vm.pagination.itemsPerPage=u.ensureInteger(t.newValue)})))},PaginationComponent.prototype.observeUpdates=function(){var e=this;this.unsubscribeCallbacks.push(this.vm.localDispatcher.subscribe(a.TableEvents.UpdateView,(function(){e.$forceUpdate()}))),this.unsubscribeCallbacks.push(this.vm.pagination.onChange(s.proxy(this.syncForm,this))),this.unsubscribeCallbacks.push(this.vm.pagination.onInvalidate(s.proxy(this.syncForm,this)))},PaginationComponent.prototype.syncForm=function(){this.form.get("page").setValue(this.vm.pagination.page),this.form.get("itemsPerPage").setValue(this.vm.pagination.itemsPerPage)},e.__decorate([v.Prop({type:Object,required:!0}),e.__metadata("design:type",i.TableViewModel)],PaginationComponent.prototype,"vm",void 0),e.__decorate([g.Computed(),e.__metadata("design:type",Boolean),e.__metadata("design:paramtypes",[])],PaginationComponent.prototype,"isOffset",null),e.__decorate([b.Expose(),e.__metadata("design:type",n.FormObject)],PaginationComponent.prototype,"form",void 0),e.__decorate([b.Expose(),e.__metadata("design:type",Function),e.__metadata("design:paramtypes",[KeyboardEvent]),e.__metadata("design:returntype",void 0)],PaginationComponent.prototype,"onPageTextControlKeyDown",null),PaginationComponent=e.__decorate([l.Component({name:"bt-table-pagination",components:[h,f,m.IconMaterialChevronRight,c.IconMaterialChevronLeft,p.IconMaterialKeyboardBackspace]})],PaginationComponent)}(d.Vue);module.exports=y;
