/*!
 * Banquette VueUi v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../_virtual/_tslib.js"),t=require("@banquette/utils-object/_cjs/prod/get-object-value"),r=require("@banquette/utils-type/_cjs/prod/is-object"),o=require("@banquette/utils-type/_cjs/prod/is-undefined"),n=require("@banquette/vue-typescript/_cjs/prod/decorator/directive.decorator"),i=require("vue");require("./popover.component.vue.js");var p=require("./popover.component.vue_vue_type_script_lang.vue.js"),s=function(){function PopoverDirective(){this.instance=null}var s;return s=PopoverDirective,PopoverDirective.prototype.created=function(e,t){this.getOrCreateInstance(e,t)},PopoverDirective.prototype.updated=function(e,t){this.getOrCreateInstance(e,t)},PopoverDirective.prototype.unmounted=function(){null!==this.instance&&(null!==this.instance.options.group?this.removeFromGroup(this.instance.options.group):this.instance.app.unmount(),this.instance=null)},PopoverDirective.prototype.getOrCreateInstance=function(e,t){var r=this,o=this.resolveOptions(e,t);return null!==this.instance&&null!==this.instance.options.group&&this.instance.options.group!==o.group&&this.removeFromGroup(this.instance.options.group),null!==o.group&&(this.instance=this.addToGroup(e,o.group,(function(){return r.createInstance(o)}))),null===this.instance?this.instance=this.createInstance(o):(o.props.target=this.instance.options.props.target,Object.assign(this.instance.options.props,o.props)),this.instance},PopoverDirective.prototype.createInstance=function(e){var t=document.createElement(e.target instanceof SVGElement?"foreignObject":"div");t.style.position="absolute";var r=i.createApp({render:function(){return i.h(p,e.props)}});return e.target.append(t),r.mount(t),{el:t,app:r,options:e}},PopoverDirective.prototype.addToGroup=function(e,t,r){if(!o.isUndefined(s.Groups[t]))return s.Groups[t].count++,s.Groups[t].instance.options.props.target.push(e),s.Groups[t].instance;var n=r();return s.Groups[t]={count:1,instance:n},n},PopoverDirective.prototype.removeFromGroup=function(e){--s.Groups[e].count||(s.Groups[e].instance.app.unmount(),delete s.Groups[e])},PopoverDirective.prototype.resolveOptions=function(e,o){var n=r.isObject(o.value)?o.value:{content:String(o.value)};return n.target=[e],{target:e,group:t.getObjectValue(Object.keys(o.modifiers||{}),0,null),props:i.reactive(n)}},PopoverDirective.Groups={},PopoverDirective=s=e.__decorate([n.Directive({name:"bt-popover"})],PopoverDirective)}();exports.PopoverDirective=s;
