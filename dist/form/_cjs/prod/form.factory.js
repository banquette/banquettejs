/*!
 * Banquette Form v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@banquette/config/_cjs/prod/config/configuration.service"),e=require("@banquette/dependency-injection/_cjs/prod/injector"),t=require("@banquette/utils-string/_cjs/prod/is-non-empty-string"),n=require("@banquette/utils-type/_cjs/prod/is-array"),o=require("@banquette/utils-type/_cjs/prod/is-object"),i=require("@banquette/utils-type/_cjs/prod/is-undefined"),a=require("./config.js"),u=require("./form-array.js"),c=require("./form-control.js"),s=require("./form-object.js"),y=function(){function FormFactory(){}return FormFactory.Create=function(r,e){++FormFactory.InnerCount;try{if(o.isObject(r)){if(r instanceof c.FormControl)return i.isUndefined(e)||r.setValidator(e),r;for(var t=n.isArray(r)?new u.FormArray([],e):new s.FormObject({},e),a=0,y=Object.keys(r);a<y.length;a++){var F=y[a],f=FormFactory.ResolveKey(F),m=FormFactory.Create(f.extended?r[F][0]:r[F],f.extended?r[F][1]:void 0);t instanceof u.FormArray?t.append(m):t.set(f.key,m)}return t}return new c.FormControl(r,e)}finally{--FormFactory.InnerCount,0===FormFactory.InnerCount&&(FormFactory.Configuration=null)}},FormFactory.ResolveKey=function(n){null===FormFactory.Configuration&&(FormFactory.Configuration=e.Injector.Get(r.ConfigurationService).get(a.FormConfigurationSymbol));var o=!1,i=FormFactory.Configuration.factory.extendedNamePrefix,u=FormFactory.Configuration.factory.extendedNameSuffix;return(t.isNonEmptyString(i)||t.isNonEmptyString(u))&&(i&&n.substring(0,i.length)===i&&(n=n.substring(i.length),o=!0),u&&n.substring(n.length-u.length)===u&&(n=n.substring(0,n.length-u.length),o=!0)),{key:n,extended:o}},FormFactory.Configuration=null,FormFactory.InnerCount=0,FormFactory}();exports.FormFactory=y;
