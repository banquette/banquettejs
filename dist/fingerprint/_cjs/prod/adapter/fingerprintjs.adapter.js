/*!
 * Banquette Fingerprint v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../_virtual/_tslib.js"),r=require("@banquette/dependency-injection/_cjs/prod/decorator/service.decorator"),t=require("@banquette/utils-misc/_cjs/prod/is-server"),i=require("@banquette/utils-type/_cjs/prod/is-undefined"),n=require("../exception/fingerprint-generator-invalid-script.exception.js"),o=require("../exception/fingerprint-generator-script-timeout.exception.js"),p=require("../constant.js"),a=function(){function FingerprintjsAdapter(){}var a;return a=FingerprintjsAdapter,FingerprintjsAdapter.prototype.generateFingerprint=function(){return new Promise((function(e,r){if(t.isServer())e("sever");else{var p=null,c=document.createElement("script"),onLoad=function(){(null!==p&&clearTimeout(p),i.isUndefined(window.FingerprintJS))?r(new n.FingerprintGeneratorInvalidScriptException("FingerprintJS not found after importing the script.")):window.FingerprintJS.load().then((function(t){t.get().then((function(r){e(r.visitorId)})).catch(r)})).catch(r)};p=setTimeout((function(){c.removeEventListener("load",onLoad),r(new o.FingerprintGeneratorScriptTimeoutException("Failed to load FingerprintJS (timeout reached)."))}),a.ScriptLoadTimeout),c.src="//cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js",c.addEventListener("load",onLoad),document.head.appendChild(c)}}))},FingerprintjsAdapter.ScriptLoadTimeout=5e3,FingerprintjsAdapter=a=e.__decorate([r.Service(p.AdapterTag)],FingerprintjsAdapter)}();exports.FingerprintjsAdapter=a;
