/*!
 * Banquette Fingerprint v0.0.0 (CommonJS)
 * (c) 2022-2022 Julien Pinto
 * Released under Apache License, Version 2.0
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../_virtual/_tslib.js"),t=require("@banquette/dependency-injection/_cjs/prod/decorator/service.decorator"),r=require("@banquette/utils-type/_cjs/prod/is-undefined"),n=require("../exception/fingerprint-generator-invalid-script.exception.js"),i=require("../exception/fingerprint-generator-script-timeout.exception.js"),o=require("../constant.js"),p=function(){function FingerprintjsAdapter(){}var p;return p=FingerprintjsAdapter,FingerprintjsAdapter.prototype.generateFingerprint=function(){return new Promise((function(e,t){var o=-1,d=document.createElement("script"),onLoad=function(){(window.clearTimeout(o),r.isUndefined(window.FingerprintJS))?t(new n.FingerprintGeneratorInvalidScriptException("FingerprintJS not found after importing the script.")):window.FingerprintJS.load().then((function(r){r.get().then((function(t){e(t.visitorId)})).catch(t)})).catch(t)};o=window.setTimeout((function(){d.removeEventListener("load",onLoad),t(new i.FingerprintGeneratorScriptTimeoutException("Failed to load FingerprintJS (timeout reached)."))}),p.ScriptLoadTimeout),d.src="//cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js",d.addEventListener("load",onLoad),document.head.appendChild(d)}))},FingerprintjsAdapter.ScriptLoadTimeout=5e3,FingerprintjsAdapter=p=e.__decorate([t.Service(o.AdapterTag)],FingerprintjsAdapter)}();exports.FingerprintjsAdapter=p;
